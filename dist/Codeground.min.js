"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),Codeground=function(){function t(e){_classCallCheck(this,t),this.tabsToggle=this.tabsToggle.bind(this),this.render=this.render.bind(this),this.options={html:e.html,css:e.css,js:e.js,htmlShow:e.htmlShow!==!1,cssShow:e.cssShow!==!1,jsShow:e.jsShow!==!1,layout:e.layout||"half",initialFull:e.initialFull||"output",style:e.style||"tabs",initialTab:e.initialTab||"css",fullscreen:e.fullscreen||!1,topbar:"tabs"===e.style||e.topbar!==!1,title:e.title||"Codeground"}}return _createClass(t,[{key:"initCodeground",value:function(t){t?this.codeground=document.getElementById(t):this.codeground=document.getElementById("codeground"),this.codeground.className="codeground",this.options.topbar&&this.createTopBar(this.options.title),this.editorsDiv=document.createElement("div"),this.editorsDiv.className+="editors half",this.codeground.appendChild(this.editorsDiv),this.outputDiv=document.createElement("div"),this.outputDiv.className+="output half",this.codeground.appendChild(this.outputDiv);var e=this.topBar.style.height.slice(0,-2);this.editorHeight=this.options.height-e,"half"===this.options.layout?this.halfWidth():"full"===this.options.layout&&this.fullWidth(this.options.initialFull),this.createEditor("html",this.editorsDiv),this.htmlEditor=document.querySelector("#html"),this.htmlEditorCode=document.querySelector("#html textarea"),this.createEditor("css",this.editorsDiv),this.cssEditor=document.querySelector("#css"),this.cssEditorCode=document.querySelector("#css textarea"),this.createEditor("js",this.editorsDiv),this.jsEditor=document.querySelector("#js"),this.jsEditorCode=document.querySelector("#js textarea"),this.keyupRender(this.htmlEditorCode),this.keyupRender(this.cssEditorCode),this.keyupRender(this.jsEditorCode);var s=document.createElement("iframe");this.outputDiv.appendChild(s),this.options.htmlShow||(document.querySelector("#html").style.display="none"),this.options.cssShow||(document.querySelector("#css").style.display="none"),this.options.jsShow||(document.querySelector("#js").style.display="none"),"tabs"===this.options.style?this.tabs():this.rows(),this.options.fullscreen&&this.fullScreen(),this.options.html&&this.preset(this.options.html,this.htmlEditorCode),this.options.css&&this.preset(this.options.css,this.cssEditorCode),this.options.js&&this.preset(this.options.js,this.jsEditorCode)}},{key:"createEditor",value:function(t){var e=document.createElement("div");e.id=t,e.className+="editor",this.editorsDiv.appendChild(e);var s=document.createElement("h3");s.textContent=t.toUpperCase(),e.appendChild(s);var i=document.createElement("textarea");e.appendChild(i)}},{key:"createTopBar",value:function(t){this.topBar=document.createElement("div"),this.topBar.id="topBar",this.topBar.className="topbar",this.codeground.appendChild(this.topBar);var e=document.createElement("h2");e.textContent=t,this.topBar.appendChild(e)}},{key:"createTabBtn",value:function(t){var e=document.createElement("button");e.id=t.toLowerCase()+"Btn",e.className="btn",e.textContent=t;var s=document.getElementById("topBar");s.appendChild(e)}},{key:"tabs",value:function(){var t=this;if(this.options.htmlShow){this.createTabBtn("HTML");var e=document.getElementById("htmlBtn");e.addEventListener("click",function(){return t.tabsToggle("html")})}if(this.options.cssShow){this.createTabBtn("CSS");var s=document.getElementById("cssBtn");s.addEventListener("click",function(){return t.tabsToggle("css")})}if(this.options.jsShow){this.createTabBtn("JS");var i=document.getElementById("jsBtn");i.addEventListener("click",function(){return t.tabsToggle("js")})}this.createTabBtn("Result");var o=document.getElementById("resultBtn");o.addEventListener("click",function(){return t.tabsToggle("result")}),this.tabsToggle(this.options.initialTab)}},{key:"tabsToggle",value:function(t){"html"===t?"block"==this.htmlEditor.style.display?(this.htmlEditor.style.display="none",this.fullWidth("output")):"none"==this.editorsDiv.style.display?(this.htmlEditor.style.display="block",this.editorsDiv.style.display="block",this.halfWidth()):(this.htmlEditor.style.display="block",this.htmlEditor.style.height="100%",this.cssEditor.style.display="none",this.jsEditor.style.display="none"):"css"===t?"block"==this.cssEditor.style.display?(this.cssEditor.style.display="none",this.fullWidth("output")):"none"==this.editorsDiv.style.display?(this.cssEditor.style.display="block",this.editorsDiv.style.display="block",this.halfWidth()):(this.htmlEditor.style.display="none",this.cssEditor.style.display="block",this.cssEditor.style.height="100%",this.jsEditor.style.display="none"):"js"===t?"block"==this.jsEditor.style.display?(this.jsEditor.style.display="none",this.fullWidth("output")):"none"==this.editorsDiv.style.display?(this.jsEditor.style.display="block",this.editorsDiv.style.display="block",this.halfWidth()):(this.htmlEditor.style.display="none",this.cssEditor.style.display="none",this.jsEditor.style.display="block",this.jsEditor.style.height="100%"):"result"===t&&("block"==this.outputDiv.style.display&&"none"==this.editorsDiv.style.display?(this.fullWidth(),this.options.html?this.tabsToggle("html"):this.options.css?this.tabsToggle("css"):this.tabsToggle("js")):"block"==this.outputDiv.style.display?this.fullWidth():(this.outputDiv.style.display="block",this.halfWidth()))}},{key:"rows",value:function(){this.editorsDiv.className+=" rows"}},{key:"fullScreen",value:function(){this.codeground.className+=" fullscreen"}},{key:"fullWidth",value:function(t){this.codeground.className+=" fullwidth",this.codeground.classList.remove("halfwidth"),"output"===t?this.editorsDiv.style.display="none":this.outputDiv.style.display="none"}},{key:"halfWidth",value:function(){this.codeground.className+=" halfwidth",this.codeground.classList.remove("fullwidth")}},{key:"keyupRender",value:function(t){var e=this;t.addEventListener("keyup",function(){return e.render()})}},{key:"preset",value:function(t,e){var s=this,i=new window.XMLHttpRequest;i.open("GET",t,!0),i.responseType="text",i.onload=function(){200===i.status||0==i.status?(e.value+=i.responseText,s.render()):console.log(t,i)},i.onerror=function(t){console.log(t)},i.send()}},{key:"render",value:function(){var t=this.prepareSource(),e=document.querySelector(".output iframe"),s=e.contentDocument;s.open(),s.write(t),s.close()}},{key:"prepareSource",value:function(){var t=this.htmlEditorCode.value,e=this.cssEditorCode.value,s=this.jsEditorCode.value,i="",o="<!doctype html>\n<html>\n\t<head>\n\t\t<meta charset='utf-8'>\n\t\t<title>Test</title>\n\n\t\t\n\t</head>\n\t<body>\n\t\n\t</body>\n</html>";return i=o.replace("</body>",t+"</body>"),e="<style>"+e+"</style>",i=i.replace("</head>",e+"</head>"),s="<script>"+s+"</script>",i=i.replace("</body>",s+"</body>")}}]),t}();